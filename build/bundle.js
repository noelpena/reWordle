/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
/******/ (() => { // webpackBootstrap
/******/ 	"use strict";
/******/ 	var __webpack_modules__ = ({

/***/ "./src/app.js":
/*!********************!*\
  !*** ./src/app.js ***!
  \********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _wordsAPI__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./wordsAPI */ \"./src/wordsAPI.js\");\n\r\n\r\n// WORD CONTROLLER\r\nconst wordCtrl = (function(){\r\n  const localStorageKeyName = \"rewordle-solution\";\r\n  const board = {\r\n    currentWord: '',\r\n    solution: '',\r\n    status: 'in-progress',\r\n    attempts: [],\r\n    results: [],\r\n    currentRow: 0,\r\n    attemptLimit: 6\r\n  };\r\n\r\n  const hasRepeatingLetters = function(word){\r\n      return /(.).*\\1/.test(word);  \r\n  }\r\n\r\n  return {\r\n    getBoard: function(){\r\n      return board;\r\n    },\r\n    getWord: function(word, callback){\r\n      _wordsAPI__WEBPACK_IMPORTED_MODULE_0__.http.get(word)\r\n      .then(data => {\r\n        // console.log(data);\r\n        callback(data);\r\n      })\r\n      .catch(err => console.log(err));\r\n    },\r\n    getSolution: function(date, callback){\r\n      const solutionExists = localStorage.getItem(localStorageKeyName); \r\n\r\n      if(solutionExists){\r\n        callback(JSON.parse(solutionExists));\r\n      } else {\r\n        _wordsAPI__WEBPACK_IMPORTED_MODULE_0__.http.getSolution(date)\r\n        .then(data => {\r\n          board.solution = data.word.toLowerCase();\r\n          localStorage.setItem(localStorageKeyName, JSON.stringify(data));\r\n          callback(data);\r\n        })\r\n        .catch(err => console.log(err));\r\n      }\r\n    },\r\n    clearStoredSolution: function(){      \r\n      localStorage.removeItem(localStorageKeyName);\r\n    },\r\n    updateCurrentWord: function(letter, toRemove = false){\r\n      if(board.currentWord.length >= 5 && !toRemove){\r\n        return false;\r\n      }\r\n\r\n      if(toRemove){\r\n        board.currentWord = board.currentWord.substring(0, board.currentWord.length - 1);\r\n        return false;\r\n      }\r\n\r\n      board.currentWord = board.currentWord + letter;\r\n    },\r\n    clearCurrentWord : function(){\r\n      board.currentWord = '';\r\n    },\r\n    addAttempt: function(word){\r\n      board.attempts.push(word);\r\n      board.currentRow++;      \r\n\r\n      if(board.currentRow === 6){\r\n        board.status = \"game over\"\r\n      }\r\n    },\r\n    addResults: function(word){\r\n      //RESULTS NEEDS TO AFFECT THE UI as well\r\n      \r\n      word = word.toLowerCase();\r\n      let solution = board.solution.toLowerCase();\r\n      const resultsArr = [];\r\n\r\n      if(word === solution){board.status = \"game over\"}\r\n\r\n      // all results as absent\r\n      for (let i = 0; i < word.length; i++){\r\n        resultsArr.push({letter: word[i], result: \"absent\"})\r\n      }\r\n\r\n      // add correct results then remove letter from solution\r\n      for (let i = 0; i < word.length; i++){        \r\n        // if(i === solution.indexOf(word[i])){\r\n        if(word[i] === solution[i]){\r\n          resultsArr[i] = {letter: word[i], result: \"correct\"};\r\n          solution = solution.replace(word[i],\" \");\r\n        }\r\n      }\r\n      // add present with check for correct results then remove letter from solution\r\n      for (let i = 0; i < word.length; i++){        \r\n        let regex = new RegExp(`${word[i]}`);\r\n        let test = regex.test(solution)\r\n        // can also use solution.includes(word[i]) instead of regex\r\n          \r\n        if(resultsArr[i].result !== \"correct\" && test){\r\n          resultsArr[i] = {letter: word[i], result: \"present\"};\r\n          solution = solution.replace(word[i],\" \");\r\n        }\r\n      }\r\n\r\n      board.results.push(resultsArr.map(item => item.result));\r\n      wordCtrl.clearCurrentWord();\r\n    },\r\n    resetBoard: function(){\r\n      board.currentWord = '';\r\n      board.solution = '';\r\n      board.status = 'in-progress';\r\n      board.attempts = [];\r\n      board.results = [];\r\n      board.currentRow = 0,\r\n      board.attemptLimit = 6\r\n    }\r\n  }\r\n})();\r\n\r\n// UI CONTROLLER\r\nconst UICtrl = (function(){\r\n  const UISelectors = {\r\n    wordInput: '#word-input',\r\n    dateInput: '#inputDate',\r\n    dateInputData: 'data-date',\r\n    setDateBtn: \"#set-date\",\r\n    selectedDate: \"#inputDate .datepicker-grid .datepicker-cell.selected\",\r\n    results: '#results', \r\n    form: '#form',\r\n    attemptOutput: '#output ul',\r\n    board: '#board',// new grid selectors\r\n    gridRow: '#board .grid-row',\r\n    emptyLetter: '.letter[data-state=\"empty\"]',\r\n    filledLetter: '.letter[data-state=\"filled\"]',\r\n    absentLetter: '.letter[data-state=\"absent\"]',\r\n    presentLetter: '.letter[data-state=\"present\"]',\r\n    correctLetter: '.letter[data-state=\"correct\"]',\r\n    keyboard: '#keyboard',\r\n    keyboardLetter: '#keyboard button.letter-key',\r\n    keyboardRow: '#keyboard .keyboard-row',\r\n  };\r\n  \r\n  return {\r\n    showAlert: function(type, message){\r\n      let {status} = wordCtrl.getBoard();\r\n      type = \"dark\";\r\n      this.clearAlert();\r\n      const wrapper = document.createElement('div');\r\n      wrapper.innerHTML = `\r\n        <div class=\"alert alert-${type} text-white bg-dark fw-bold fade show\" role=\"alert\" id=\"re-alert\">\r\n           <div>${message}</div>          \r\n        </div>`;\r\n\r\n      document.querySelector(UISelectors.results).append(wrapper);\r\n      if(status !== \"game over\"){\r\n        setTimeout(() =>{\r\n          const alert = bootstrap.Alert.getOrCreateInstance('#re-alert');\r\n          alert.close();\r\n        }, 1800);\r\n        setTimeout(this.clearAlert, 2000);\r\n      }\r\n    },\r\n    clearAlert: function(){\r\n      document.querySelector(UISelectors.results).innerHTML = '';\r\n    },\r\n    getSelectors: function(){\r\n      return UISelectors;\r\n    },\r\n    getWordInput: function(){\r\n      let board = wordCtrl.getBoard();\r\n      let letters = document.querySelectorAll(UISelectors.gridRow + `:nth-child(${board.currentRow+1}) .letter`);\r\n      letters = Array.from(letters);\r\n\r\n      let word = letters.map(letter => letter.dataset.letter).join(\"\");\r\n      word = word.toLowerCase();\r\n      return word;\r\n    },\r\n    getDateInput: function(){\r\n      const date = document.querySelector(UISelectors.dateInput).getAttribute(UISelectors.dateInputData);\r\n      const dateArr = date.split('-');\r\n     \r\n      return `${dateArr[2]}-${dateArr[0]}-${dateArr[1]}`;\r\n    },\r\n    clearBoard: function(){\r\n      // need to add \r\n      //some animation to flip/spinn all tiles\r\n      let letters = document.querySelectorAll(UISelectors.gridRow + ' .letter');\r\n      letters = Array.from(letters);\r\n\r\n      letters.forEach(letter => {\r\n        letter.textContent = '';\r\n        letter.dataset.letter = '';\r\n        letter.dataset.state = 'empty';\r\n      });\r\n    },\r\n    clearKeyboard: function(){\r\n      let keyLetters = document.querySelectorAll(UISelectors.keyboardLetter);\r\n      keyLetters = Array.from(keyLetters);\r\n\r\n      keyLetters.forEach(letter => {\r\n        letter.dataset.state = 'empty';\r\n      });\r\n    },\r\n    addLetterInput: function(newKey){\r\n      let board = wordCtrl.getBoard();\r\n      const currentWord = board.currentWord;\r\n\r\n      if(currentWord.length === 5){\r\n        return false;\r\n      }\r\n\r\n      if(currentWord.length <= 5){\r\n        let box = \r\n        document.querySelector(\r\n          UISelectors.gridRow + \r\n          `:nth-child(${board.currentRow+1})` +\r\n          ' ' +\r\n          UISelectors.emptyLetter\r\n        );\r\n        box.textContent = newKey.toUpperCase();\r\n        box.dataset.state = 'filled';\r\n        box.dataset.letter = newKey;\r\n      }\r\n    },\r\n    backspaceLetterInput: function(){\r\n      let board = wordCtrl.getBoard();\r\n      if(board.currentWord.length === 0){\r\n        return false;\r\n      }\r\n\r\n      let box = document.querySelector(\r\n        UISelectors.gridRow + \r\n        `:nth-child(${board.currentRow+1})` +\r\n        ' ' +\r\n        UISelectors.filledLetter +\r\n        `:nth-child(${board.currentWord.length})`\r\n      );\r\n\r\n      box.textContent = '';\r\n      box.dataset.state = 'empty';\r\n      box.dataset.letter = '';\r\n    },\r\n    updateKeyboard: function(){\r\n      let board = wordCtrl.getBoard();\r\n      const lastAttempt = Array.from(board.attempts[board.currentRow-1])\r\n\r\n      lastAttempt.forEach((letter, i) => {\r\n        const result = board.results[board.currentRow-1][i];\r\n        document.querySelector(UISelectors.keyboardLetter + `[data-key=\"${letter}\"]`).dataset.state = result;\r\n      });\r\n    },\r\n    showLastAttempt: function(callback){\r\n      let board = wordCtrl.getBoard();\r\n      let letters = document.querySelectorAll(UISelectors.gridRow + `:nth-child(${board.currentRow}) .letter`);\r\n      letters = Array.from(letters);\r\n\r\n      let i = 0\r\n      letters[i].classList.add('animate__animated', 'animate__flip', 'animate__faster');\r\n      letters[i].dataset.state = board.results[board.currentRow-1][i];      \r\n      i++;\r\n\r\n      const flipAnimation = setInterval(() => {\r\n        if (i === 4) {\r\n          window.clearInterval(flipAnimation);\r\n        }\r\n        letters[i].classList.add('animate__animated', 'animate__flip', 'animate__faster');\r\n        letters[i].dataset.state = board.results[board.currentRow-1][i];\r\n        i++;\r\n      }, 500);      \r\n\r\n      setTimeout(() => {\r\n        this.updateKeyboard();\r\n        if(board.attempts[board.currentRow-1] === board.solution){\r\n          this.correctWordAnimate(board)\r\n        } else{          \r\n          callback();\r\n        }\r\n      },2800);      \r\n    },\r\n    correctWordAnimate: function(board){\r\n      let letters = document.querySelectorAll(UISelectors.gridRow + `:nth-child(${board.currentRow}) .letter`);\r\n      letters = Array.from(letters);\r\n\r\n      board.results[board.currentRow-1].forEach((result, i) => {\r\n        letters[i].classList.remove('animate__animated', 'animate__flip', 'animate__faster');\r\n      });\r\n\r\n      let i = 0\r\n      letters[i].classList.add('animate__animated','animate__bounce','animate__faster');\r\n      letters[i].dataset.state = board.results[board.currentRow-1][i];      \r\n      i++;\r\n\r\n      const bounceAnimation = setInterval(() => {\r\n         if (i === 4) {\r\n           window.clearInterval(bounceAnimation);\r\n         }\r\n         letters[i].classList.add('animate__animated','animate__bounce','animate__faster');\r\n         letters[i].dataset.state = board.results[board.currentRow-1][i];\r\n         i++;\r\n       }, 150);\r\n    }   \r\n  }\r\n})();\r\n\r\n// APP CONTROLLER\r\nconst App = (function(wordCtrl, UICtrl){\r\n  const todaysDateInput = function(){\r\n    const UISelectors = UICtrl.getSelectors();\r\n\r\n    const today = new Date()\r\n    const yesterday = new Date(today)\r\n\r\n    yesterday.setDate(yesterday.getDate() - 1)\r\n\r\n    let month = yesterday.getMonth() + 1;\r\n    month = month < 10 ? '0' + month : month;\r\n    const year = yesterday.getFullYear();\r\n    let day = yesterday.getDate();\r\n    day = day < 10 ? '0' + day : day;\r\n\r\n    const elem = document.querySelector(UISelectors.dateInput);\r\n    const datepicker = new Datepicker(elem, {\r\n      minDate: '06-19-2021',\r\n      maxDate: `${month}-${day}-${year}`\r\n    }); \r\n    document.querySelector(UISelectors.dateInput).setAttribute('data-date',`${month}-${day}-${year}`);\r\n    document.querySelector(UISelectors.dateInput + ' .datepicker-grid span.focused').classList.add(\"selected\");\r\n  }\r\n\r\n  const removeStoredSolution = function(){\r\n    wordCtrl.clearStoredSolution();\r\n  }\r\n\r\n  const map = {}; \r\n  const loadEventListeners = function(){\r\n    // GET UI SELECTORS\r\n    const UISelectors = UICtrl.getSelectors();\r\n    document.querySelector(UISelectors.setDateBtn).addEventListener('click', dateChange);\r\n    keydownEventListener(true);        \r\n    document.querySelector(UISelectors.keyboard).addEventListener('click', keyboardClick);\r\n    document.addEventListener('keyup', (e) => {\r\n      e.type == 'keyup' && delete map[e.key.toLowerCase()]\r\n      // console.log(map)\r\n    });\r\n  };\r\n  \r\n  const keyboardClick = function(e){\r\n    e.preventDefault();\r\n\r\n    let key = e.target.dataset.key;\r\n    const isEmpty = Object.keys(e.target.dataset).length === 0;\r\n\r\n    if(isEmpty){\r\n      return false;\r\n    }\r\n\r\n    key = key.toLowerCase();\r\n    \r\n    if(key === 'backspace'){\r\n      UICtrl.backspaceLetterInput();\r\n      wordCtrl.updateCurrentWord(e.key, true);\r\n      return false;\r\n    }  \r\n\r\n    if(key === 'enter'){\r\n      getWord();\r\n      return false;\r\n    }\r\n  \r\n    UICtrl.addLetterInput(key);\r\n    wordCtrl.updateCurrentWord(key);\r\n    \r\n  };\r\n\r\n  const keydownEventListener = function(isOn){\r\n    if(!isOn){\r\n      document.removeEventListener('keydown', typeWord);\r\n      return false;\r\n    }\r\n\r\n    document.addEventListener('keydown', typeWord);\r\n  }\r\n  \r\n  const formatDate = function(date, isYesterday = false){\r\n    const d = new Date(date);\r\n    \r\n    let month = d.getMonth() + 1;\r\n    month = month < 10 ? '0' + month : month;\r\n    const year = d.getFullYear();\r\n    let day = d.getDate();\r\n    day = day < 10 ? '0' + day : day;\r\n\r\n    return `${month}-${day}-${year}`\r\n  };\r\n\r\n  const dateChange = function(e){\r\n    // update datepicker data attr value\r\n    const UISelectors = UICtrl.getSelectors();\r\n    const selectedDate = document.querySelector(UISelectors.selectedDate).getAttribute('data-date');\r\n    const date = formatDate(parseInt(selectedDate));\r\n    \r\n    document.querySelector(UISelectors.dateInput).setAttribute('data-date', date);\r\n\r\n    // close modal\r\n    var dateModal = document.getElementById('dateModal');\r\n    var modal = bootstrap.Modal.getInstance(dateModal);\r\n    modal.hide();\r\n\r\n    UICtrl.clearBoard();\r\n    UICtrl.clearKeyboard();\r\n    UICtrl.clearAlert();\r\n    wordCtrl.resetBoard();\r\n    wordCtrl.clearStoredSolution();\r\n    keydownEventListener(true);\r\n  };\r\n  \r\n  const typeWord = function(e){\r\n    e.preventDefault();\r\n    \r\n    let code = e.code.toLowerCase();\r\n    let regex = /key/gi;\r\n\r\n    map[e.key.toLowerCase()] = e.type == 'keydown'; \r\n    // CAN CHECK FOR MULTIPLE KEYBOARD PRESS AT A TIME\r\n    // NO CURRENT USE CASE BUT MAYBE IN THE FUTURE\r\n  \r\n    // if(map['control'] && map['b']){ // CTRL+R\r\n    // }else if(map[17] && map[16] && map[66]){ // CTRL+SHIFT+B\r\n    //   alert('Control Shift B');\r\n    // }else if(map[17] && map[16] && map[67]){ // CTRL+SHIFT+C\r\n    //   alert('Control Shift C');\r\n    // }\r\n    //  console.log(map)\r\n\r\n    // IF F5, Refresh the page duhh\r\n    if(e.code === 'F5' || e.key === 'F5' || e.keyCode === 116){\r\n      window.location.reload();\r\n    }  \r\n\r\n    if(e.code === 8 || e.key === 'Backspace' || e.keyCode === 8){\r\n      //if(!result && (e.code === 8 || e.key === 'Backspace' || e.keyCode === 8)){\r\n      UICtrl.backspaceLetterInput();\r\n      wordCtrl.updateCurrentWord(e.key, true);\r\n      return false;\r\n    }  \r\n\r\n    if(e.code === 13 || e.key === 'Enter' || e.keyCode === 13){\r\n      getWord();\r\n      return false;\r\n    }  \r\n    \r\n    let result = regex.test(code);\r\n    if(result){// TYPE LETTER IN INPUT      \r\n      UICtrl.addLetterInput(e.key);\r\n      wordCtrl.updateCurrentWord(e.key);\r\n    } \r\n  }\r\n\r\n  const getWord = function(){\r\n    const word = UICtrl.getWordInput();\r\n    const date = UICtrl.getDateInput();\r\n\r\n    if(word === '' || word.length !== 5){\r\n      UICtrl.showAlert('warning', 'Not enough letters.');\r\n      return false;\r\n    }\r\n\r\n    wordCtrl.getWord(word, wordData => {\r\n      let success = wordData.hasOwnProperty('word');\r\n        if(!success){\r\n          UICtrl.showAlert('danger', 'Not in word list');\r\n          return false;\r\n        }\r\n  \r\n        wordCtrl.addAttempt(word);        \r\n\r\n        let board = wordCtrl.getBoard();\r\n\r\n        // success does the word match?\r\n        wordCtrl.getSolution(date, solution => {\r\n          wordCtrl.addResults(word);\r\n          keydownEventListener(false);\r\n          UICtrl.showLastAttempt(() => {\r\n            keydownEventListener(true);  \r\n          });\r\n          const correctWord = solution.word.toLowerCase();\r\n          if(board.currentRow === board.attemptLimit && word !== correctWord){\r\n            // GAME IS OVER            \r\n            keydownEventListener(false);\r\n            UICtrl.showAlert('info', correctWord);\r\n            return false;\r\n          }\r\n\r\n          if(correctWord === word){\r\n            UICtrl.showAlert('success', 'Word Matches!');\r\n            keydownEventListener(false);\r\n          } else{\r\n            //UICtrl.showAlert('warning', 'Word doesn\\'t match');\r\n            // add animation here\r\n          }\r\n        });\r\n    });\r\n  };\r\n  \r\n  return{\r\n    init: function(){\r\n      console.log(\"Initializing App...\");\r\n\r\n      removeStoredSolution();\r\n      loadEventListeners();\r\n      todaysDateInput();\r\n    }\r\n  }\r\n})(wordCtrl, UICtrl);\r\n\r\nApp.init();\n\n//# sourceURL=webpack://rewordle/./src/app.js?");

/***/ }),

/***/ "./src/wordsAPI.js":
/*!*************************!*\
  !*** ./src/wordsAPI.js ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"http\": () => (/* binding */ http)\n/* harmony export */ });\n/**\r\n * EASY HTTP Library\r\n */\r\n\r\n// import Bank from \"../api/bank.json\";\r\n// const wordsURL = 'https://wordsapiv1.p.rapidapi.com/words/';\r\n\r\nclass EasyHTTP{\r\n  async get(word){\r\n    const response = await fetch(`../api/bank.json`);\r\n    const data = await response.json();\r\n    for (const w of data){\r\n      if(w === word){return {word: w}}\r\n    }\r\n  };\r\n\r\n  async getSolution(date){\r\n    const response = await fetch(`../api/db.json`);\r\n    const data = await response.json();\r\n    for (const w of data.pastSolutions){\r\n      if(w.date === date){return w}\r\n    }\r\n   }\r\n}\r\n\r\nconst http = new EasyHTTP();\r\n\n\n//# sourceURL=webpack://rewordle/./src/wordsAPI.js?");

/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/ 	
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		var cachedModule = __webpack_module_cache__[moduleId];
/******/ 		if (cachedModule !== undefined) {
/******/ 			return cachedModule.exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			// no module.id needed
/******/ 			// no module.loaded needed
/******/ 			exports: {}
/******/ 		};
/******/ 	
/******/ 		// Execute the module function
/******/ 		__webpack_modules__[moduleId](module, module.exports, __webpack_require__);
/******/ 	
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/ 	
/************************************************************************/
/******/ 	/* webpack/runtime/define property getters */
/******/ 	(() => {
/******/ 		// define getter functions for harmony exports
/******/ 		__webpack_require__.d = (exports, definition) => {
/******/ 			for(var key in definition) {
/******/ 				if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {
/******/ 					Object.defineProperty(exports, key, { enumerable: true, get: definition[key] });
/******/ 				}
/******/ 			}
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/hasOwnProperty shorthand */
/******/ 	(() => {
/******/ 		__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/make namespace object */
/******/ 	(() => {
/******/ 		// define __esModule on exports
/******/ 		__webpack_require__.r = (exports) => {
/******/ 			if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 				Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 			}
/******/ 			Object.defineProperty(exports, '__esModule', { value: true });
/******/ 		};
/******/ 	})();
/******/ 	
/************************************************************************/
/******/ 	
/******/ 	// startup
/******/ 	// Load entry module and return exports
/******/ 	// This entry module can't be inlined because the eval devtool is used.
/******/ 	var __webpack_exports__ = __webpack_require__("./src/app.js");
/******/ 	
/******/ })()
;